<div class="min-h-screen bg-gray-50 dark:bg-gray-900 py-8 px-4 sm:px-6 lg:px-8">
  <div class="max-w-7xl mx-auto">
    <!-- Back Button -->
    <div class="bg-white dark:bg-gray-800 rounded-xl p-4 sm:p-6 mb-6 shadow-sm border border-gray-200 dark:border-gray-700 flex items-center gap-4">
      <button type="button"
              class="bg-gray-100 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-300 px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-all duration-200 hover:bg-gray-200 dark:hover:bg-gray-600 hover:-translate-y-0.5"
              [routerLink]="['/vendor-rfqs']">
        ‚Üê {{ 'VENDOR.BACK_TO_RFQS' | translate }}
      </button>
      <div class="text-lg font-semibold text-gray-900 dark:text-white">
        {{ 'VENDOR.RFQ_DETAILS' | translate }}
      </div>
      <div class="text-center ml-auto px-3 py-1.5 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-800 dark:text-yellow-200 border border-yellow-200 dark:border-yellow-700 rounded-full text-xs font-medium uppercase tracking-wide">
        {{ quotes.length || 0 }} {{ 'VENDOR.QUOTES_RECEIVED' | translate }}
      </div>
    </div>

    <!-- Main Content Card -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 mb-8 overflow-hidden">
      <div class="bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700 p-8 relative">

        <!-- Header with Quotes Count and Title -->
        <div class="flex justify-between items-start mb-6 gap-6">
          <div>
            <h1 class="text-xl sm:text-2xl lg:text-3xl font-bold mb-2 text-shadow">
              {{ rfq.title }}
            </h1>
            <div class="text-base opacity-90 font-medium">
              {{ 'VENDOR.RFQ_ID' | translate }}: #{{ rfq.id }}
            </div>
          </div>
        </div>

        <!-- Project Details Grid -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 mt-6">
          <div class="bg-white/10 backdrop-blur-sm lg:p-5 rounded-xl border border-white/20">
            <div class="text-xs uppercase tracking-wide opacity-80 mb-2">
              {{ 'VENDOR.QUANTITY' | translate }}
            </div>
            <div class="text-lg font-semibold">
              {{ rfq.quantity | number:'1.0-2' }} {{ rfq.unit?.name }}
            </div>
          </div>

          <div class="bg-white/10 backdrop-blur-sm lg:p-5 rounded-xl border border-white/20">
            <div class="text-xs uppercase tracking-wide opacity-80 mb-2">
              {{ 'VENDOR.LOCATION' | translate }}
            </div>
            <div class="text-lg font-semibold">
              {{ rfq.jobLocation }}
            </div>
          </div>

          <div class="bg-white/10 backdrop-blur-sm lg:p-5 rounded-xl border border-white/20">
            <div class="text-xs uppercase tracking-wide opacity-80 mb-2">
              {{ 'VENDOR.POSTED_DATE' | translate }}
            </div>
            <div class="text-lg font-semibold">
              {{ rfq.submissionDate | date:'MMM dd, yyyy' }}
            </div>
          </div>

          <!-- <div class="bg-white/10 backdrop-blur-sm lg:p-5 rounded-xl border border-white/20">
            <div class="text-xs uppercase tracking-wide opacity-80 mb-2">
              {{ 'VENDOR.DEADLINE' | translate }}
            </div>
            <div class="text-lg font-semibold">
              {{ rfq?.deadline | date:'MMM dd, yyyy' }}
            </div>
          </div> -->
        </div>
      </div>

      <div class="p-8">
        <!-- Project Description -->
        <div class="mb-8">
          <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-3">
            <div class="w-1 h-6 bg-gradient-to-b from-blue-600 to-blue-800 dark:from-blue-400 dark:to-blue-600 rounded-sm"></div>
            {{ 'VENDOR.PROJECT_DESCRIPTION' | translate }}
          </h2>
          <div [innerHTML]="rfq.description" class="quill-content text-base leading-relaxed text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700/50 p-6 rounded-xl border-l-4 border-blue-600 dark:border-blue-400">
          </div>
        </div>

        <!-- Required Categories & Specializations -->
        <div class="mb-8">
          <h2 class="text-xl font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-3">
            <div class="w-1 h-6 bg-gradient-to-b from-blue-600 to-blue-800 dark:from-blue-400 dark:to-blue-600 rounded-sm"></div>
            {{ 'VENDOR.REQUIRED_CATEGORIES_AND_SPECIALIZATIONS' | translate }}
          </h2>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="bg-gray-50 dark:bg-gray-700/50 p-5 rounded-xl border border-gray-200 dark:border-gray-600">
              <h3 class="text-base font-semibold text-gray-900 dark:text-white mb-3">
                {{ 'VENDOR.PRIMARY_CATEGORIES' | translate }}
              </h3>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let category of rfq?.categories"
                     class="px-3 py-1.5 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border border-blue-200 dark:border-blue-700 rounded-full text-xs font-medium">
                  {{ category.name }}
                </div>
              </div>
            </div>

            <!-- Specializations -->
            <div *ngIf="rfq?.subcategories?.length"
                 class="bg-gray-50 dark:bg-gray-700/50 p-5 rounded-xl border border-gray-200 dark:border-gray-600">
              <h3 class="text-base font-semibold text-gray-900 dark:text-white mb-3">
                {{ 'VENDOR.SPECIALIZATIONS' | translate }}
              </h3>
              <div class="flex flex-wrap gap-2">
                <div *ngFor="let subcategory of rfq?.subcategories"
                     class="px-3 py-1.5 bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-200 dark:border-green-700 rounded-full text-xs font-medium">
                  {{ subcategory.name }}
                </div>
              </div>
            </div>
          </div>
        </div>
        <div *ngIf="rfq?.media?.items?.[0]">
          <p class="text-medium text-gray-600 dark:text-gray-300 mt-1 mb-5">
            {{'VENDOR.DOCUMENTS' | translate}}
          </p>

          <div class="border-b border-gray-200 dark:border-gray-700" *ngFor="let file of rfq?.media?.items">

            <!-- IMAGE -->
            <div *ngIf="['.png', '.jpg', '.jpeg', '.gif'].includes(file.extension)" (click)="previewImageInFullScreen(file.url, 'img')" class="pointer py-2">
              üñºÔ∏è Image <span>{{file.name}}</span>
            </div>

            <!-- PDF -->
            <div *ngIf="file.extension === '.pdf'" class="pointer py-2" (click)="downloadFile(file, 'pdf')">
              üìÑ PDF <span>{{file.name}}</span>
            </div>

            <!-- Text File -->
            <div *ngIf="file.extension === '.txt'" class="pointer py-2" (click)="downloadFile(file, 'txt')">
              üìã Text File <span>{{file.name}}</span>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- Vendor Quotes Section -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden">
      <div class="bg-gray-50 dark:bg-gray-700/50 p-6 border-b-2 border-gray-200 dark:border-gray-600 flex justify-between items-center flex-wrap gap-4">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white">
          {{ 'VENDOR.VENDOR_QUOTES' | translate }}
        </h2>

        <!-- Quote Statistics -->
        <div class="flex gap-6 items-center">
          <div class="text-center">
            <span class="text-xl font-bold text-gray-900 dark:text-white block">{{ quotes.length || 0 }}</span>
            <span class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide">{{ 'VENDOR.TOTAL_QUOTES' | translate }}</span>
          </div>
          <div class="text-center">
            <span class="text-xl font-bold text-gray-900 dark:text-white block">{{ pendingCount }}</span>
            <span class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide">{{ 'VENDOR.PENDING' | translate }}</span>
          </div>
          <div class="text-center">
            <span class="text-xl font-bold text-gray-900 dark:text-white block">{{ acceptedCount }}</span>
            <span class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide">{{ 'VENDOR.ACCEPTED' | translate }}</span>
          </div>
          <div class="text-center">
            <span class="text-xl font-bold text-gray-900 dark:text-white block">${{ rfq.quotesAveragePrice | number:'1.0-2' }}</span>
            <span class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide">Avg Price</span>
          </div>
        </div>
      </div>


      <!-- Filters and Sorting -->
      <!-- <div class="p-5 bg-gray-50 dark:bg-gray-700/50 border-b border-gray-200 dark:border-gray-600 flex gap-4 items-center flex-wrap">
        <div class="flex flex-col gap-1">
          <label class="text-xs text-gray-600 dark:text-gray-400 font-medium">{{ 'VENDOR.SORT_BY' | translate }}</label>
          <select class="py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white min-w-[120px]">
            <option>{{ 'VENDOR.PRICE_LOW_TO_HIGH' | translate }}</option>
            <option>{{ 'VENDOR.PRICE_HIGH_TO_LOW' | translate }}</option>
            <option>{{ 'VENDOR.RATING' | translate }}</option>
            <option>{{ 'VENDOR.EXPERIENCE' | translate }}</option>
            <option>{{ 'VENDOR.DATE_SUBMITTED' | translate }}</option>
          </select>
        </div>
        <div class="flex flex-col gap-1">
          <label class="text-xs text-gray-600 dark:text-gray-400 font-medium">{{ 'VENDOR.STATUS' | translate }}</label>
          <select class="py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white min-w-[120px]">
            <option>{{ 'VENDOR.ALL_STATUSES' | translate }}</option>
            <option>{{ 'VENDOR.PENDING' | translate }}</option>
            <option>{{ 'VENDOR.ACCEPTED' | translate }}</option>
            <option>{{ 'VENDOR.REJECTED' | translate }}</option>
          </select>
        </div>
        <div class="flex flex-col gap-1">
          <label class="text-xs text-gray-600 dark:text-gray-400 font-medium">{{ 'VENDOR.PRICE_RANGE' | translate }}</label>
          <select class="py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-white min-w-[120px]">
            <option>{{ 'VENDOR.ALL_PRICES' | translate }}</option>
            <option>{{ 'VENDOR.UNDER_100K' | translate }}</option>
            <option>{{ 'VENDOR.100K_150K' | translate }}</option>
            <option>{{ 'VENDOR.OVER_150K' | translate }}</option>
          </select>
        </div>
      </div> -->

      <div class="p-6">
        <div *ngIf="!quotes || quotes.length === 0" class="text-center text-gray-600 dark:text-gray-400 py-10 text-lg font-medium">
          {{ 'VENDOR.NO_QUOTES_YET' | translate }}
        </div>
        <div *ngFor="let quote of quotes"
          class="border-2 rounded-xl mb-5 overflow-hidden transition-all duration-200 bg-white dark:bg-gray-800 hover:shadow-lg"
          [ngClass]="getQuoteCardClasses(quote.status).border">

        <div class="bg-gradient-to-r p-5 relative"
            [ngClass]="getQuoteCardClasses(quote.status).header">
                  <div class="flex justify-between items-start gap-5">
              <div class="flex-1">
                <h3 class="text-xl font-bold mb-2">
                  {{ quote.vendor.firstName + ' ' + quote.vendor.lastName || quote.submission.title }}
                </h3>
              </div>
              <div class="text-right">
                <div class="text-3xl font-extrabold mb-1">
                  ${{ quote.price | number:'1.0-0' }}
                </div>
                <div class="text-xs opacity-80 uppercase">
                  {{ 'VENDOR.TOTAL_COST' | translate }}
                </div>
              </div>
            </div>
          </div>

          <!-- Quote Details Grid -->
          <div class="p-6">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-6">
              <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg text-center border border-gray-200 dark:border-gray-600">
                <div class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1.5">
                  {{ 'VENDOR.TIMELINE' | translate }}
                </div>
                <div class="text-base font-bold text-gray-900 dark:text-white">
                  {{quote.minimumTimelineDuration}} - {{quote.maximumTimelineDuration}} {{quote.timelineIntervalType?.name}}
                </div>
              </div>

              <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg text-center border border-gray-200 dark:border-gray-600">
                <div class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1.5">
                  {{ 'VENDOR.WARRANTY' | translate }}
                </div>
                <div class="text-base font-bold text-gray-900 dark:text-white">
                  {{quote.warantyDuration}} {{quote.warantyIntervalType?.name}}
                </div>
              </div>

              <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg text-center border border-gray-200 dark:border-gray-600">
                <div class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1.5">
                  {{ 'VENDOR.START_DATE' | translate }}
                </div>
                <div class="text-base font-bold text-gray-900 dark:text-white">
                  {{ quote.created | date:'MMM dd, yyyy' }}
                </div>
              </div>

              <div class="bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg text-center border border-gray-200 dark:border-gray-600">
                <div class="text-xs text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1.5">
                  {{ 'VENDOR.SUBMITTED' | translate }}
                </div>
                <div class="text-base font-bold text-gray-900 dark:text-white">
                  {{ quote.submission.submissionDate | date:'MMM dd, yyyy' }}
                </div>
              </div>
            </div>

            <!-- Vendor Proposal -->
            <div class="bg-slate-50 dark:bg-gray-700/30 p-5 rounded-lg border-l-4 border-blue-600 dark:border-blue-400 mb-6">
              <div class="text-sm font-semibold text-gray-900 dark:text-white mb-2">
                {{ 'VENDOR.VENDOR_PROPOSAL' | translate }}
              </div>
              <div [innerHTML]="quote.description" class="text-sm text-gray-600 dark:text-gray-300 leading-relaxed quill-content">
              </div>
            </div>

            <!-- Actions -->
            <div class="flex justify-between items-center flex-wrap gap-3 pt-5 border-t border-gray-200 dark:border-gray-600">
              <div class="flex items-center gap-2">
                <span *ngIf="quote.status"
                      class="px-3 py-1.5 rounded-full text-xs font-semibold uppercase tracking-wide"
                      [ngClass]="getStatusColor(quote.status)">
                  {{ quote.status.name }}
                </span>
              </div>
              <div class="flex gap-2 flex-wrap">
                <button *ngIf="currentUser?.type === 'Administrator'" (click)="onChangeStatus(quote, quote.status?.name === 'Invalid' ? 1 : 4)"
                  class="w-full sm:w-auto px-5 justify-center py-2.5 rounded-lg text-sm font-medium border-none cursor-pointer transition-all duration-200 inline-flex items-center gap-1.5 bg-yellow-500 hover:bg-yellow-600 text-white hover:-translate-y-0.5">
                  <svg class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="12 2 22 20 2 20 12 2" />
                    <line x1="12" y1="8" x2="12" y2="14" />
                    <circle cx="12" cy="17" r="1" />
                  </svg>
                  {{ quote.status?.name === 'Invalid' ? ('VENDOR.MARK_AS_VALID' | translate) : ('VENDOR.MARK_AS_INVALID' | translate) }}
                </button>
                <button *ngIf="currentUser?.type === 'Customer' && quote.status?.name !== 'Accepted' && quote.status?.name !== 'Invalid'" (click)="onChangeStatus(quote, 2)"
                        class="w-full sm:w-auto px-5 justify-center px-5 py-2.5 rounded-lg text-sm font-medium border-none cursor-pointer transition-all duration-200 inline-flex items-center gap-1.5 bg-green-600 hover:bg-green-700 text-white hover:-translate-y-0.5">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
                            clip-rule="evenodd"></path>
                        </svg>
                   {{ 'VENDOR.ACCEPT' | translate }}
                </button>
                <button *ngIf="currentUser?.type === 'Customer' && quote.status?.name !== 'Rejected' && quote.status?.name !== 'Invalid'" (click)="onChangeStatus(quote, 3)"
                        class="w-full sm:w-auto px-5 justify-center px-5 py-2.5 rounded-lg text-sm font-medium border-none cursor-pointer transition-all duration-200 inline-flex items-center gap-1.5 bg-red-500 hover:bg-red-600 text-white hover:-translate-y-0.5">
                        <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd"
                            d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z"
                            clip-rule="evenodd"></path>
                        </svg>
                   {{ 'VENDOR.REJECT' | translate }}
                </button>
                <button *ngIf="currentUser?.type === 'Customer'" class="w-full sm:w-auto px-5 justify-center px-5 py-2.5 rounded-lg text-sm font-medium border border-gray-300 dark:border-gray-600 cursor-pointer transition-all duration-200 inline-flex items-center gap-1.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 hover:-translate-y-0.5" (click)="sendQuoteFirstMessage(quote)">
                  <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                    <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                  </svg>
                   {{ 'VENDOR.MESSAGE' | translate }}
                </button>
                <button class="w-full sm:w-auto px-5 justify-center px-5 py-2.5 rounded-lg text-sm font-medium border-none cursor-pointer transition-all duration-200 inline-flex items-center gap-1.5 bg-blue-600 hover:bg-blue-700 text-white hover:-translate-y-0.5" [routerLink]="['/quote-details', quote.id]">
                  <svg class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg>
                   {{ 'VENDOR.VIEW_DETAILS' | translate }}
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
