<!-- Main Layout Wrapper -->
<div class="flex flex-col flex-grow dark:bg-dark-900">
  <div class="flex flex-col flex-grow">
    <!-- Toolbar -->
    <div class="py-4 lg:py-8">
      <div class="w-full max-w-7xl mx-auto flex flex-wrap justify-between items-center">
        <div class="flex flex-wrap justify-between items-center gap-4 w-full">
          <div class="flex flex-col justify-center gap-1 me-3">
            <h1 class="text-gray-900 dark:text-white font-bold text-2xl m-0">
              Account Settings
            </h1>
            <ul class="flex items-center gap-2 text-sm font-semibold my-0">
              <li class="text-gray-500 dark:text-gray-400">
                <a class="text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 cursor-pointer">Home</a>
              </li>
              <li>
                <span class="bg-gray-500 dark:bg-gray-600 w-1 h-0.5 block rounded-full"></span>
              </li>
              <li class="text-gray-500 dark:text-gray-400">Account</li>
              <li>
                <span class="bg-gray-500 dark:bg-gray-600 w-1 h-0.5 block rounded-full"></span>
              </li>
              <li class="text-gray-900 dark:text-white font-medium">{{ selectedTab }}</li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <!-- Content Section -->
    <div class="flex-grow">
      <div class="w-full max-w-7xl mx-auto">
        <div class="bg-white dark:bg-dark-800 shadow rounded-xl mb-10">
          <div class="p-6 pt-9 pb-0">
            <!-- User Info Card -->
            <div class="flex flex-wrap sm:flex-nowrap" *ngIf="currentUser">
              <!-- Avatar -->
              <div class="me-7 mb-4">
                <div class="relative w-24 h-24 sm:w-40 sm:h-40">
                  <ng-container *ngIf="currentUser?.profilePicture; else initials">
                    <img [src]="currentUser.profilePicture" alt="image" class="w-full h-full rounded-full object-cover" />
                  </ng-container>
                  <ng-template #initials>
                    <div class="flex items-center justify-center w-full h-full border border-dashed rounded-full bg-gray-100 dark:bg-dark-600 font-bold text-xl">
                      {{ getUserInitials() }}
                    </div>
                  </ng-template>
                  <div class="absolute bottom-0 left-full translate-x-[-50%] translate-y-[50%] bg-green-500 border-4 border-white dark:border-dark-800 rounded-full h-5 w-5"></div>
                </div>
              </div>

              <!-- User Details -->
              <div class="flex-grow">
                <div class="flex justify-between items-start flex-wrap mb-2">
                  <div class="flex flex-col">
                    <!-- Full Name -->
                    <div class="flex items-center mb-2">
                      <a class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 text-2xl font-bold me-1" title="full-name">
                        {{ getUserDisplayName() }}
                      </a>
                      <a title="icon">
                        <i class="ki-outline ki-verify text-blue-600 dark:text-blue-400 text-xl"></i>
                      </a>
                    </div>

                    <!-- Email -->
                    <div class="flex flex-wrap font-medium text-sm text-gray-500 dark:text-gray-400 mb-2 pe-2">
                      <a title="email" class="flex items-center hover:text-blue-600 dark:hover:text-blue-400 me-5 mb-2">
                        <i class="ki-outline ki-sms text-base me-1"></i>
                        {{ currentUser.email }}
                      </a>
                    </div>

                    <!-- Phone -->
                    <div class="flex flex-wrap font-medium text-sm text-gray-500 dark:text-gray-400 mb-2 pe-2">
                      <a title="phone" class="flex items-center hover:text-blue-600 dark:hover:text-blue-400 mb-2">
                        <i class="ki-outline ki-phone text-base me-1"></i>
                        {{ currentUser.phoneNumber }}
                      </a>
                    </div>

                    <!-- Role -->
                    <a title="profession" class="flex items-center text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 text-sm me-5 mb-2">
                      <i class="ki-outline ki-profile-circle text-base me-1"></i>
                      {{ getRoleDisplayName() }}
                    </a>
                  </div>
                </div>
              </div>
            </div>

            <!-- Tabs -->
            <mat-tab-group
              (selectedTabChange)="onTabChange($event)"
              class="w-full sm:w-[300px] md:w-[400px]"
              [selectedIndex]="selectedTab === 'Overview' ? 0 : 1"
            >
              <mat-tab label="Overview"></mat-tab>
              <mat-tab label="Settings"></mat-tab>
            </mat-tab-group>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tab Content -->
  <div class="w-full max-w-7xl mx-auto">
    <ng-container *ngIf="selectedTab === 'Overview'">
      <app-profile-overview [user]="currentUser"></app-profile-overview>
    </ng-container>
    <ng-container *ngIf="selectedTab === 'Settings'">
      <app-profile-settings
        [user]="currentUser"
        (updateProfile)="onProfileUpdated()"
      ></app-profile-settings>
    </ng-container>
  </div>
</div>